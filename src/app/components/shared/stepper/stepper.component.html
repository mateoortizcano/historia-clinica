<div class="stepper-container">
  <!-- Progress Bar -->
  <div class="progress mb-4" style="height: 8px;">
    <div
      class="progress-bar"
      role="progressbar"
      [style.width.%]="progressPercentage()"
      [attr.aria-valuenow]="progressPercentage()"
      aria-valuemin="0"
      aria-valuemax="100"
    >
    </div>
  </div>

  <!-- Steps Indicator -->
  <div class="steps-indicator mb-4">
    <div class="steps-wrapper">
      @for (step of steps(); track step.id; let i = $index) {
        <div 
          class="step-item"
          [class.active]="i === currentStepIndex()"
          [class.completed]="step.completed"
          [class.clickable]="canNavigateToStep(i)"
          (click)="canNavigateToStep(i) ? goToStep(i) : null"
        >
          <div class="step-circle">
            @if (step.completed) {
              <i class="bi bi-check-lg"></i>
            } @else {
              <span>{{ i + 1 }}</span>
            }
          </div>
          <div class="step-label">{{ step.label }}</div>
        </div>
        
        @if (i < steps().length - 1) {
          <div class="step-connector" [class.completed]="step.completed"></div>
        }
      }
    </div>
  </div>

  <!-- Step Content -->
  <div class="step-content">
    <ng-content></ng-content>
  </div>

  <!-- Navigation Buttons -->
  <div class="step-navigation mt-4">
    <div class="d-flex justify-content-between align-items-center gap-3">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="previousStep()"
        [disabled]="isFirstStep()"
      >
        <i class="bi bi-arrow-left me-2"></i>
        Anterior
      </button>

      <div class="step-counter text-muted">
        <small>Paso {{ currentStepIndex() + 1 }} de {{ steps().length }}</small>
      </div>

      <button
        type="button"
        class="btn btn-primary"
        (click)="nextStep()"
        [disabled]="!currentStep().valid"
      >
        @if (isLastStep()) {
          Finalizar
          <i class="bi bi-check-lg ms-2"></i>
        } @else {
          Siguiente
          <i class="bi bi-arrow-right ms-2"></i>
        }
      </button>
    </div>

    @if (!currentStep().valid) {
      <div class="alert alert-warning mt-3 mb-0">
        <small>
          <i class="bi bi-exclamation-triangle me-1"></i>
          Complete todos los campos requeridos para continuar
        </small>
      </div>
    }
  </div>
</div>

